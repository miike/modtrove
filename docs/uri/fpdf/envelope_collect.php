<?phpdefine('FPDF_FONTPATH','font/');require('fpdf.php');require('../include/functions.php');require('barcode.php');class PDF extends FPDF{	//Page header	function Header()	{		$this->Image('img/logolg.jpg', 5, 5, 25);		$this->Image('img/susu.jpg', 195, 5, 20);	}	//Page footer	function Footer()	{		$this->SetFont('Arial','',8);		$text = $GLOBALS['cinfo']['name'].", ".$GLOBALS['cinfo']['address1'].", ";		$this->Text(5,101,$text);		$text = $GLOBALS['cinfo']['address2'].", ".$GLOBALS['cinfo']['address3'].", ".$GLOBALS['cinfo']['town'].", ".$GLOBALS['cinfo']['postcode'].".";		$this->Text(5,103.5,$text);		$text = "Phone: ".$GLOBALS['cinfo']['phone']." Email: ".$GLOBALS['cinfo']['email'].", Web: ".$GLOBALS['cinfo']['web'];		$this->Text(5,106,$text);	}	function printthispage($orderid)	{		$this->AddPage();		$this->SetFont('Arial','B',12);		$text = "Student ID:";		$this->Text(40,20,$text);		$text = "Name:";		$this->Text(40,25,$text);		$text = "Email:";		$this->Text(40,30,$text);		$text = "Order Code:";		$this->Text(40,35,$text);		$this->SetLineWidth(0.4);		$this->SetDrawColor(51,51,204);		$this->Rect(38,15,100,22);		$sql = "SELECT custstudid, custfname, custsname, custemail, custphoneno, ordercode, orderid";		$sql .=" FROM orders";		$sql .=" INNER  JOIN customers ON orders.custid = customers.custid WHERE orderid = $orderid";		$result = runQuery($sql,'fetch custid from orders (envelope)');		$row = mysql_fetch_array($result);		$this->SetFont('Arial','',12);		$this->Text(70,20,$row[custstudid]);		$this->Text(70,25,$row[custsname].", ".$row[custfname]);		$this->Text(70,30,$row[custemail]);		$this->Text(70,35,$row[ordercode]);		//ticket bit		$sql =" SELECT ob.ticketid as ticket_id, ti.ticketname, sum( ob.tickamount ) as qty ";		$sql .=" FROM orderbits ob";		$sql .=" LEFT  JOIN ticket ti ON ti.ticketid = ob.ticketid";		$sql .=" WHERE ob.orderid =".$orderid." AND ob.inactive =0";		$sql .=" GROUP  BY ob.ticketid";		$result = runQuery($sql,'fetch orderbits from orders (envolope)');		$ypos = 44;		$i = 0;		$this->SetFillColor(51,51,204);		$this->SetFont('Arial','',10);		$this->Rect(39,40,98,5,'F');		$this->SetTextColor(255,255,255);		$this->Text(40,$ypos,"Tickets");		$this->SetTextColor(0,0,0);		while($rowb = mysql_fetch_array($result))		{			$i++;			$this->Text(40,$ypos+($i*5),$rowb['qty']." x ".getTicketName($rowb['ticket_id']));		}		$this->Rect(38,39,100,((($i+1)*5)+2));		$this->Rect(169,89,42,12);		Barcode39 ($row[orderid], 800, 200, 100,'JPEG', 0);		$this->Image('temp.jpg', 170, 90, 40);	}}//start output$pdf=new PDF('L','mm','dl');if($_REQUEST[id] == "all"){		set_time_limit (1000);	$sql_all = "select o.orderid from orders o					left join customers c on o.custid=c.custid					left join user_users u on u.user_id=o.orderstartby					where o.orderstatus='To Prepare' and o.inactive=0 and u.user_group=$_COOKIE[user_group] order by c.custsname,c.custfname";	$res_all = runQuery($sql_all, "make all envelopes");	while($row_all = mysql_fetch_array($res_all) )	{		$pdf->printthispage($row_all[orderid]);	}}else{	$pdf->printthispage($_REQUEST[id]);}$pdf->Output();?>